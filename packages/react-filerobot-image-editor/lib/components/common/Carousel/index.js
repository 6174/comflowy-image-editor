"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=_interopRequireWildcard(require("react")),_icons=require("@scaleflex/icons"),_hooks=require("../../../hooks"),_debounce=_interopRequireDefault(require("../../../utils/debounce")),_getScrollOffset3=_interopRequireDefault(require("../../../utils/getScrollOffset")),_Carousel=require("./Carousel.styled");function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(b,c){if(!c&&b&&b.__esModule)return b;if(null===b||"object"!=_typeof(b)&&"function"!=typeof b)return{default:b};var d=_getRequireWildcardCache(c);if(d&&d.has(b))return d.get(b);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in b)if("default"!=a&&Object.prototype.hasOwnProperty.call(b,a)){var g=f?Object.getOwnPropertyDescriptor(b,a):null;g&&(g.get||g.set)?Object.defineProperty(e,a,g):e[a]=b[a]}return e["default"]=b,d&&d.set(b,e),e}var Carousel=function(a){var b=a.children,c=a.style,d=a.className,f=(0,_react.useRef)(!1),g=(0,_react.useRef)(),h=(0,_hooks.useResizeObserver)(),i=(0,_slicedToArray2["default"])(h,1),j=i[0],k=(0,_react.useState)(!1),l=(0,_slicedToArray2["default"])(k,2),m=l[0],n=l[1],o=(0,_react.useState)(!1),p=(0,_slicedToArray2["default"])(o,2),q=p[0],r=p[1],s=_react.Children.toArray(b),t=function(){if(g.current){var a=g.current,b=a.scrollWidth,c=a.offsetWidth,d=a.scrollLeft,e=Math.round(b-c),f=Math.round(e-d);n(0<d),r(0<f)}},u=function(a,b){var c=a.findIndex(function(a){return a.classList.contains("FIE_carousel-item")});-1!==c&&(a[c].scrollIntoView({inline:b,behavior:"smooth",block:"nearest"}),setTimeout(function(){t()},500))},v=function(a){if(f.current){var b,c=((null===(b=a.touches)||void 0===b?void 0:b[0])||a).pageX;g.current.scrollBy(f.current-c,0),f.current=c,(0,_debounce["default"])(t,30)()}},w=function(){f.current=null,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",w),document.removeEventListener("touchmove",v),document.removeEventListener("touchcancel",w),document.removeEventListener("touchend",w)},x=function(a){var b;f.current=((null===(b=a.touches)||void 0===b?void 0:b[0])||a).pageX,document.addEventListener("mousemove",v),document.addEventListener("mouseup",w),document.addEventListener("touchmove",v),document.addEventListener("touchcancel",w),document.addEventListener("touchend",w)};return(0,_react.useEffect)(function(){g.current&&j(g.current,t)},[]),_react["default"].createElement(_Carousel.StyledCarouselWrapper,{className:"".concat(d,"-wrapper"),style:c,onMouseDown:x,onTouchStart:x},m&&_react["default"].createElement(_Carousel.StyledPrevArrowWrapper,{className:"FIE_carousel-prev-button",onClick:function scrollToPrev(a){var b=(0,_getScrollOffset3["default"])(),c=b.topOffset,d=b.leftOffset,e=document.elementsFromPoint(a.pageX+a.currentTarget.offsetWidth-d,a.pageY-c);u(e,"end")}},_react["default"].createElement(_icons.ArrowLeftOutline,null)),_react["default"].createElement(_Carousel.StyledCarousel,{className:"".concat(d,"-items"),ref:g},s.map(function(a){return _react["default"].createElement(_Carousel.StyledCarouselItem,{className:"".concat(d,"-item-wrapper FIE_carousel-item"),key:a.key},a)})),q&&_react["default"].createElement(_Carousel.StyledNextArrowWrapper,{className:"FIE_carousel-next-button",onClick:function scrollToNext(a){var b=(0,_getScrollOffset3["default"])(),c=b.topOffset,d=b.leftOffset,e=document.elementsFromPoint(a.pageX-a.currentTarget.offsetWidth-d,a.pageY-c);u(e,"start")}},_react["default"].createElement(_icons.ArrowRightOutline,null)))};Carousel.defaultProps={style:null};var _default=exports["default"]=Carousel;