"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_react=_interopRequireWildcard(require("react")),_hooks=require("../../../hooks"),_core=require("@scaleflex/ui/core"),_menu=_interopRequireDefault(require("@scaleflex/ui/core/menu")),_transparency=_interopRequireDefault(require("@scaleflex/icons/transparency")),_shadow=_interopRequireDefault(require("@scaleflex/icons/shadow")),_stroke=_interopRequireDefault(require("@scaleflex/icons/stroke")),_position=_interopRequireDefault(require("@scaleflex/icons/position")),_OpacityField=_interopRequireDefault(require("./OpacityField")),_StrokeFields=_interopRequireDefault(require("./StrokeFields")),_ShadowFields=_interopRequireDefault(require("./ShadowFields")),_PositionFields=_interopRequireDefault(require("./PositionFields")),_AnnotationOptions=require("./AnnotationOptions.styled"),_AnnotationOptions2=require("./AnnotationOptions.constants"),_ColorInput=_interopRequireDefault(require("../ColorInput")),_excluded=["children","morePoppableOptionsPrepended","moreOptionsPopupComponentsObj","morePoppableOptionsAppended","annotation","updateAnnotation","hideFillOption","hidePositionField","className"];function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(b,c){if(!c&&b&&b.__esModule)return b;if(null===b||"object"!=_typeof(b)&&"function"!=typeof b)return{default:b};var d=_getRequireWildcardCache(c);if(d&&d.has(b))return d.get(b);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in b)if("default"!=a&&Object.prototype.hasOwnProperty.call(b,a)){var g=f?Object.getOwnPropertyDescriptor(b,a):null;g&&(g.get||g.set)?Object.defineProperty(e,a,g):e[a]=b[a]}return e["default"]=b,d&&d.set(b,e),e}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var AnnotationOptions=function(a){var b=a.children,c=a.morePoppableOptionsPrepended,d=a.moreOptionsPopupComponentsObj,e=a.morePoppableOptionsAppended,f=a.annotation,g=a.updateAnnotation,h=a.hideFillOption,i=a.hidePositionField,j=a.className,k=(0,_objectWithoutProperties2["default"])(a,_excluded),l=(0,_react.useState)(null),m=(0,_slicedToArray2["default"])(l,2),n=m[0],o=m[1],p=(0,_react.useState)(null),q=(0,_slicedToArray2["default"])(p,2),r=q[0],s=q[1],u=(0,_hooks.useStore)(),v=u.config.useCloudimage,w=u.t,t=(0,_hooks.usePhoneScreen)(320),x=(0,_react.useMemo)(function(){return[].concat((0,_toConsumableArray2["default"])(c),[{titleKey:"opacity",name:_AnnotationOptions2.POPPABLE_OPTIONS.OPACITY,Icon:_transparency["default"]}],(0,_toConsumableArray2["default"])(v?[]:[{titleKey:"stroke",name:_AnnotationOptions2.POPPABLE_OPTIONS.STROKE,Icon:_stroke["default"]},{titleKey:"shadow",name:_AnnotationOptions2.POPPABLE_OPTIONS.SHADOW,Icon:_shadow["default"]}]),[i?void 0:{titleKey:"position",name:_AnnotationOptions2.POPPABLE_OPTIONS.POSITION,Icon:_position["default"]}])},[c]),y=(0,_react.useMemo)(function(){return _objectSpread(_objectSpread({},d),{},(0,_defineProperty2["default"])((0,_defineProperty2["default"])((0,_defineProperty2["default"])((0,_defineProperty2["default"])({},_AnnotationOptions2.POPPABLE_OPTIONS.OPACITY,_OpacityField["default"]),_AnnotationOptions2.POPPABLE_OPTIONS.STROKE,_StrokeFields["default"]),_AnnotationOptions2.POPPABLE_OPTIONS.SHADOW,_ShadowFields["default"]),_AnnotationOptions2.POPPABLE_OPTIONS.POSITION,_PositionFields["default"]),e)},[d]),z=(0,_react.useCallback)(function(a,b){var c=null===a||void 0===a?void 0:a.currentTarget;o(c),s(b)},[]),A=(0,_react.useCallback)(function(a){g({fill:a})},[g]),B=n&&r&&y[r];return _react["default"].createElement(_AnnotationOptions.StyledOptions,{className:"FIE_annotations-options".concat(j?" ".concat(j):""),isPhoneScreen:t},!h&&_react["default"].createElement(_ColorInput["default"],{color:f.fill,onChange:A,colorFor:"fill"}),b,_react["default"].createElement(_AnnotationOptions.StyledOptionsWrapper,null,x.map(function(a){return a&&_react["default"].createElement(_AnnotationOptions.StyledIconWrapper,{className:"FIE_annotation-option-triggerer",key:a.name,title:w(a.titleKey),onClick:function onClick(b){return z(b,a.name)},active:r===a.name},_react["default"].createElement(a.Icon,{size:20}))})),B&&_react["default"].createElement(_menu["default"],{className:"FIE_annotation-option-popup",anchorEl:n,open:!!n,onClose:z,position:"top"},_react["default"].createElement(_AnnotationOptions.StyledOptionPopupContent,null,r===_AnnotationOptions2.POPPABLE_OPTIONS.POSITION?function renderPositionFields(){return _react["default"].createElement(_react["default"].Fragment,null,_react["default"].createElement(_core.Label,null,w("position")),_react["default"].createElement(_AnnotationOptions.StyledOptionPopupContent,{position:!0},_react["default"].createElement(B,(0,_extends2["default"])({annotation:f,updateAnnotation:g},k))))}():_react["default"].createElement(B,(0,_extends2["default"])({annotation:f,updateAnnotation:g},k)))))};AnnotationOptions.defaultProps={children:void 0,morePoppableOptionsPrepended:[],moreOptionsPopupComponentsObj:{},morePoppableOptionsAppended:[],hideFillOption:!1,hidePositionField:!1,className:void 0};var _default=exports["default"]=AnnotationOptions;