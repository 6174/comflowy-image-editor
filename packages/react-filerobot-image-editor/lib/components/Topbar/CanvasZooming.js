"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_react=_interopRequireWildcard(require("react")),_icons=require("@scaleflex/icons"),_menu=_interopRequireDefault(require("@scaleflex/ui/core/menu")),_menuItem=_interopRequireWildcard(require("@scaleflex/ui/core/menu-item")),_actions=require("../../actions"),_constants=require("../../utils/constants"),_hooks=require("../../hooks"),_getZoomFitFactor=_interopRequireDefault(require("../../utils/getZoomFitFactor")),_toPrecisedFloat=_interopRequireDefault(require("../../utils/toPrecisedFloat")),_Topbar=require("./Topbar.styled"),_Topbar2=require("./Topbar.constants");function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(b,c){if(!c&&b&&b.__esModule)return b;if(null===b||"object"!=_typeof(b)&&"function"!=typeof b)return{default:b};var d=_getRequireWildcardCache(c);if(d&&d.has(b))return d.get(b);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in b)if("default"!=a&&Object.prototype.hasOwnProperty.call(b,a)){var g=f?Object.getOwnPropertyDescriptor(b,a):null;g&&(g.get||g.set)?Object.defineProperty(e,a,g):e[a]=b[a]}return e["default"]=b,d&&d.set(b,e),e}var MULTIPLY_ZOOM_FACTOR=1.1,CanvasZooming=function(a){var b=a.showBackButton,c=(0,_hooks.useStore)(),d=c.dispatch,e=c.zoom,f=void 0===e?{}:e,g=c.toolId,h=c.feedback,i=c.t,j=c.shownImageDimensions,k=c.resize,l=c.originalImage,m=c.adjustments.crop,n=c.config.useZoomPresetsMenu,o=0===h.duration,p=(0,_react.useState)(null),q=(0,_slicedToArray2["default"])(p,2),r=q[0],s=q[1],t=function(a,b){d({type:_actions.ZOOM_CANVAS,payload:{factor:a,isAbsoluteZoom:b}})},u=function(){var a=k.width&&k.height&&k||m.width&&m.height&&m||j,b=(0,_getZoomFitFactor["default"])(m.width&&m.height&&m||j,a);t(b||_constants.DEFAULT_ZOOM_FACTOR,!0)},v=function(a){s(r?null:a.target)},w=function(a){if("fit"===a)return u(),void v();var b=k.width||k.height?a:Math.min(a*l.width/j.width,a*l.height/j.height);t(b,!0),v()},x=g===_constants.TOOLS_IDS.CROP||o,y=!l||k.width||k.height?f.factor:Math.min(j.width*f.factor/l.width,j.height*f.factor/l.height);return _react["default"].createElement(_Topbar.StyledZoomingWrapper,null,_react["default"].createElement(_Topbar.StyledSmallButton,{onClick:function zoomOut(){t(f.factor/MULTIPLY_ZOOM_FACTOR)},color:"basic",title:i("zoomOutTitle"),disabled:x,showBackButton:b,className:"FIE_topbar-zoom-out-btn"},_react["default"].createElement(_icons.MinusOutline,null)),_react["default"].createElement(_Topbar.StyledZoomPercentageLabel,{title:i("toggleZoomMenuTitle"),onClick:x?void 0:n&&v||u,"aria-disabled":x,className:"FIE_topbar-zoom-label"},"".concat((0,_toPrecisedFloat["default"])(100*y,0),"%")),_react["default"].createElement(_Topbar.StyledSmallButton,{onClick:function zoomIn(){t(f.factor*MULTIPLY_ZOOM_FACTOR)},color:"basic",title:i("zoomInTitle"),disabled:x,showBackButton:b,className:"FIE_topbar-zoom-in-btn"},_react["default"].createElement(_icons.PlusOutline,null)),_react["default"].createElement(_menu["default"],{anchorEl:r,onClose:v,open:!!r,position:"bottom",className:"FIE_topbar-zoom-menu"},_Topbar2.ZOOM_FACTORS_PRESETS.map(function(a){var b=a.factor,c=a.labelKey,d=a.label;return _react["default"].createElement(_menuItem["default"],{key:d||c,onClick:function onClick(){return w(b)}},_react["default"].createElement(_menuItem.MenuItemLabel,null,null!==d&&void 0!==d?d:i(c)))})))};CanvasZooming.defaultProps={showBackButton:!1};var _default=exports["default"]=CanvasZooming;