"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=require("react"),_actions=require("../actions"),_constants=require("../utils/constants"),_useStore2=_interopRequireDefault(require("./useStore")),useAnnotationEvents=function(){var a=(0,_useStore2["default"])(),b=a.tabId,c=a.dispatch,d=(0,_react.useMemo)(function(){return b!==_constants.TABS_IDS.ANNOTATE&&b!==_constants.TABS_IDS.WATERMARK},[b]),f=(0,_react.useCallback)(function(a){c({type:_actions.SET_ANNOTATION,payload:a})},[]),g=(0,_react.useCallback)(function(a){f({id:a.target.id(),x:a.target.x(),y:a.target.y()})},[]),h=(0,_react.useCallback)(function(a){var b={id:a.target.id(),rotation:a.target.rotation(),x:a.target.x(),y:a.target.y()};return a.target.name()===_constants.TOOLS_IDS.TEXT?(b.width=a.target.width()*a.target.scaleX(),b.height=a.target.height()*a.target.scaleY(),b.scaleX=1,b.scaleY=1):(b.scaleX=a.target.scaleX(),b.scaleY=a.target.scaleY()),b},[]),i=(0,_react.useCallback)(function(a){f(h(a))},[]),j=(0,_react.useCallback)(function(a){a.target.name()===_constants.TOOLS_IDS.TEXT&&a.target.setAttrs(h(a))}),k=(0,_react.useCallback)(function(a){if(!(a.target.id()===_constants.WATERMARK_ANNOTATION_ID||a.target.getStage().attrs.isDrawing)){var b=a.evt.ctrlKey||a.evt.shiftKey||a.evt.metaKey;c({type:_actions.SELECT_ANNOTATION,payload:{annotationId:a.target.id(),multiple:b}}),c({type:_actions.SELECT_TOOL,payload:{toolId:a.target.name(),keepSelections:b}})}},[]);return(0,_react.useMemo)(function(){return d?{}:{onTransform:j,onTransformEnd:i,onDragEnd:g,onClick:k,onTap:k}},[d])},_default=exports["default"]=useAnnotationEvents;