"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.dimensToProperAnnotationDimens=exports["default"]=exports.NO_WIDTH_HEIGHT_ANNOTATIONS=void 0;var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_konva=_interopRequireDefault(require("konva")),_constants=require("../../utils/constants"),_excluded=["width","height","startedX","startedY"];function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var annotationsNamesToKonvaClasses=(0,_defineProperty2["default"])((0,_defineProperty2["default"])((0,_defineProperty2["default"])((0,_defineProperty2["default"])((0,_defineProperty2["default"])((0,_defineProperty2["default"])((0,_defineProperty2["default"])({},_constants.TOOLS_IDS.RECT,_konva["default"].Rect),_constants.TOOLS_IDS.ELLIPSE,_konva["default"].Ellipse),_constants.TOOLS_IDS.POLYGON,_konva["default"].RegularPolygon),_constants.TOOLS_IDS.LINE,_konva["default"].Line),_constants.TOOLS_IDS.IMAGE,_konva["default"].Image),_constants.TOOLS_IDS.TEXT,_konva["default"].Text),_constants.TOOLS_IDS.ARROW,_konva["default"].Arrow),ANNOTATIONS_WITH_POINTS=[_constants.TOOLS_IDS.LINE,_constants.TOOLS_IDS.ARROW],NO_WIDTH_HEIGHT_ANNOTATIONS=exports.NO_WIDTH_HEIGHT_ANNOTATIONS=[].concat(ANNOTATIONS_WITH_POINTS,[_constants.TOOLS_IDS.ELLIPSE,_constants.TOOLS_IDS.POLYGON]),getNewAnnotationPreview=function(a){var b,c,d;return new annotationsNamesToKonvaClasses[a.name](_objectSpread(_objectSpread({},a),{},{opacity:null!==(b=a.opacity)&&void 0!==b?b:.7,x:null!==(c=a.x)&&void 0!==c?c:0,y:null!==(d=a.y)&&void 0!==d?d:0,width:Math.abs(a.width)||0,height:Math.abs(a.height)||0},ANNOTATIONS_WITH_POINTS.includes(a.name)?{stroke:a.stroke||"#000000"}:{}))},dimensToProperAnnotationDimens=exports.dimensToProperAnnotationDimens=function(a,b,c){var d=a.width,e=a.height,f=a.startedX,g=a.startedY,h=(0,_objectWithoutProperties2["default"])(a,_excluded),i=Math.abs(d),j=Math.abs(e),k=0>d,l=0>e;switch(b){case _constants.TOOLS_IDS.RECT:c?(h.width=Math.sqrt(i*i+j*j),h.height=h.width,h.x-=k?h.width-i:0,h.y-=l?h.height-j:0):(h.width=i,h.height=j);break;case _constants.TOOLS_IDS.ELLIPSE:c?(h.radiusX=Math.sqrt(i*i+j*j)/2,h.radiusY=h.radiusX,h.x-=k?2*h.radiusX-i:0,h.y-=l?2*h.radiusY-j:0):(h.radiusX=i/2,h.radiusY=j/2),h.offsetX=-h.radiusX,h.offsetY=-h.radiusY;break;case _constants.TOOLS_IDS.POLYGON:h.radius=(i+j)/2,h.x-=k?2*h.radius-i:0,h.y-=l?2*h.radius-j:0,h.offsetX=-h.radius,h.offsetY=-h.radius;break;case _constants.TOOLS_IDS.LINE:case _constants.TOOLS_IDS.ARROW:h.x=f,h.y=g,h.points=[0,0],c?h.points.push(i>=j?d:0,j>i?e:0):h.points=[0,0,d,e];break;default:h.width=i,h.height=j}return h},_default=exports["default"]=getNewAnnotationPreview;